<!DOCTYPE html>
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body> 
        
        <h2>Log in</h2>
        <form action="#" method="post">
            
            Username : <input name="username" type="text" value="" /> <br />
            <p></p>
            Password : <input name="password" type="password" /> <br />
            <br />
            
            <input type="submit" value="submit" />
            
        </form>
        
         <div id="confirmation"></div>
         
         <script type="text/javascript" src="js/ajax.js"></script>
         <script type="text/javascript">
        
            var form = document.querySelector('form');
            var confirmation = document.querySelector('#confirmation');

            form.addEventListener('submit', checkForm);


            function checkForm(e) {
                e.preventDefault();

                 var username = document.querySelector('input[name="username"]');
                 var password = document.querySelector('input[name="password"]');

                 var data = 'username='+username.value+'&password='+password.value;

                 var url = 'http://localhost/api/is-valid-login.php';
                 var verb = 'POST';
                 /* promises take two call backs, one for the success and one for the failure */
                 window.makeRequestPromise(url, verb, data).then(window.httpResolve, window.httpResolveError);

            }
        
                    
             function httpResolve(response) {                        
              
                console.log(this.response);

                if ( response.data.loginValid ) {
                    window.confirmation.innerHTML = 'Login Valid';
                } else {
                    window.confirmation.innerHTML = 'Login is not valid';
                }
                                      
             }
             
             function httpResolveError(err) {                        
              
                console.log(err);

                                                     
             }

                   
        
        </script>
    </body>
</html>

        